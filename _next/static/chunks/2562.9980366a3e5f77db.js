"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2562],{3682:function(l,d,i){var t=i(5893);i(7294);var o=i(4633),n=i(5007),e=i(5260),r=i(188),a=i(1642);d.Z=l=>{let{showSingleSellerModal:d,setSingleSellerModal:i,product:u,selectedVariant:v}=l,s=(0,n.I0)(),c=(0,n.v9)(l=>l.Theme.theme),_=(0,n.v9)(l=>l.Cart),m=async()=>{try{let t=await r.al();if(1==t.status){s((0,a.RV)({data:[]})),s((0,a.OW)({data:0})),s((0,a.Sq)({data:[]}));let t=await r.Xq({product_id:null==u?void 0:u.id,product_variant_id:null==v?void 0:v.id,qty:1});if(1===t.status){var l,d;if((null==_?void 0:null===(d=_.cartProducts)||void 0===d?void 0:null===(l=d.find(l=>(null==l?void 0:l.product_id)==(null==u?void 0:u.id)&&(null==l?void 0:l.product_variant_id)==(null==v?void 0:v.id)))||void 0===l?void 0:l.qty)==void 0){s((0,a.RV)({data:t}));let l={product_id:null==u?void 0:u.id,product_variant_id:null==v?void 0:v.id,qty:1};s((0,a.Sq)({data:[l]})),s((0,a.OW)({data:null==t?void 0:t.sub_total}))}i(!1)}}}catch(l){console.log("Error",l)}};return(0,t.jsxs)(o.Vq,{open:d,children:[(0,t.jsx)(o.t9,{className:"".concat("light"==c?"bg-white/80":"bg-black/80")}),(0,t.jsx)(o.cZ,{children:(0,t.jsxs)("div",{className:"",children:[(0,t.jsxs)("div",{className:"flex flex-col gap-2 font-bold",children:[(0,t.jsx)("span",{children:(0,e.t)("single_seller_warning")}),(0,t.jsx)("span",{children:(0,e.t)("clear_cart_warning")})]}),(0,t.jsxs)("div",{className:"flex gap-2 mt-2",children:[(0,t.jsxs)("button",{className:"px-4 py-1 bg-red-700 text-white font-bold rounded-sm",onClick:()=>{i(!1)},children:[" ",(0,e.t)("cancel")]}),(0,t.jsx)("button",{className:"px-4 py-1 bg-green-700 text-white font-bold rounded-sm",onClick:m,children:(0,e.t)("Ok")})]})]})})]})}},2562:function(l,d,i){var t=i(5893),o=i(4633),n=i(8773),e=i(188),r=i(5007),a=i(5260),u=i(1828),v=i(2594),s=i(1642),c=i(5678),_=i(927),m=i(3682),p=i(7294);d.Z=l=>{var d;let{product:i,showVariants:x,setShowVariants:f}=l,h=(0,r.I0)(),y=(0,r.v9)(l=>l.Setting),b=(0,r.v9)(l=>l.Cart),[g,j]=(0,p.useState)([]),[N,k]=(0,p.useState)(!1),q=l=>{var d,i,t,o;return(null==b?void 0:b.isGuest)===!1&&(null==b?void 0:null===(i=b.cartProducts)||void 0===i?void 0:null===(d=i.find(d=>(null==d?void 0:d.product_variant_id)==(null==l?void 0:l.id)))||void 0===d?void 0:d.qty)>0||(null==b?void 0:b.isGuest)===!0&&(null==b?void 0:null===(o=b.guestCart)||void 0===o?void 0:null===(t=o.find(d=>(null==d?void 0:d.product_variant_id)===(null==l?void 0:l.id)))||void 0===t?void 0:t.qty)>0},w=l=>{var d,i,t,o;return!1===b.isGuest?null==b?void 0:null===(i=b.cartProducts)||void 0===i?void 0:null===(d=i.find(d=>(null==d?void 0:d.product_variant_id)==(null==l?void 0:l.id)))||void 0===d?void 0:d.qty:null==b?void 0:null===(o=b.guestCart)||void 0===o?void 0:null===(t=o.find(d=>(null==d?void 0:d.product_variant_id)==(null==l?void 0:l.id)))||void 0===t?void 0:t.qty},C=l=>(null==l?void 0:l.is_unlimited_stock)==0&&(null==l?void 0:l.stock)<=0,P=l=>Object.entries(null==l?void 0:l.reduce((l,d)=>{let i=l[d.product_id]||0;return{...l,[d.product_id]:i+d.qty}},{})).map(l=>{let[d,i]=l;return{product_id:parseInt(d),qty:i}}),S=async(l,d,i)=>{j(d);try{let r=await e.Xq({product_id:l,product_variant_id:d.id,qty:i});if(1===r.status){var t,o,n;if((null==b?void 0:null===(o=b.cartProducts)||void 0===o?void 0:null===(t=o.find(i=>(null==i?void 0:i.product_id)==l&&(null==i?void 0:i.product_variant_id)==d.id))||void 0===t?void 0:t.qty)==void 0){h((0,s.RV)({data:r}));let t=[...null==b?void 0:b.cartProducts,{product_id:l,product_variant_id:d.id,qty:i}];h((0,s.Sq)({data:t})),h((0,s.OW)({data:null==r?void 0:r.sub_total}))}else{let t=null==b?void 0:null===(n=b.cartProducts)||void 0===n?void 0:n.map(t=>t.product_id==l&&(null==t?void 0:t.product_variant_id)==d.id?{...t,qty:i}:t);h((0,s.RV)({data:r})),h((0,s.Sq)({data:t})),h((0,s.OW)({data:null==r?void 0:r.sub_total}))}}else k(!0)}catch(l){console.log("error",l)}},A=async(l,d)=>{try{let t=await e.h2({product_id:l,product_variant_id:null==d?void 0:d.id});if((null==t?void 0:t.status)===1){var i;let l=null==b?void 0:null===(i=b.cartProducts)||void 0===i?void 0:i.filter(l=>(null==l?void 0:l.product_variant_id)!=(null==d?void 0:d.id));h((0,s.OW)({data:null==t?void 0:t.sub_total})),h((0,s.Sq)({data:l}))}else c.Am.error(t.message)}catch(l){console.log("error",l)}},O=(l,d,i,t,o,n)=>{let e=(null==i?void 0:i.discounted_price)!==0?null==i?void 0:i.discounted_price:null==i?void 0:i.price;if(o){var r,a;let l;0!==t?("add"==n?h((0,s.Nj)({data:e})):"remove"==n&&h((0,s.kO)({data:e})),l=null==b?void 0:null===(r=b.guestCart)||void 0===r?void 0:r.map(l=>(null==l?void 0:l.product_id)==d&&(null==l?void 0:l.product_variant_id)==i.id?{...l,qty:t}:l)):("add"==n?h((0,s.Nj)({data:e})):"remove"==n&&h((0,s.kO)({data:e})),l=null==b?void 0:null===(a=b.guestCart)||void 0===a?void 0:a.filter(l=>(null==l?void 0:l.product_variant_id)!=i.id)),h((0,s.Ss)({data:l}))}else{"add"==n?h((0,s.Nj)({data:e})):"remove"==n&&h((0,s.kO)({data:e}));let l={product_id:d,product_variant_id:i.id,qty:t,productPrice:e};h((0,s.Ss)({data:[...null==b?void 0:b.guestCart,l]}))}},V=(l,d,i,t)=>{var o;let n=null==l?void 0:null===(o=l.find(l=>(null==l?void 0:l.product_id)==(null==d?void 0:d.id)))||void 0===o?void 0:o.qty;Number(0!==d.is_unlimited_stock)?n>=Number(null==d?void 0:d.total_allowed_quantity)?c.Am.error((0,a.t)("max_cart_limit_error")):O(d,null==d?void 0:d.id,t,i,1,"add"):n>=Number(null==t?void 0:t.stock)?c.Am.error((0,a.t)("out_of_stock_message")):n>=Number(null==d?void 0:d.total_allowed_quantity)?c.Am.error((0,a.t)("max_cart_limit_error")):O(d,null==d?void 0:d.id,t,i,1,"add")},G=(l,d,i)=>{var t;((null==l?void 0:null===(t=l.find(l=>(null==l?void 0:l.product_id)==(null==d?void 0:d.id)))||void 0===t?void 0:t.qty)||0)>=Number(null==d?void 0:d.total_allowed_quantity)?c.Am.error((0,a.t)("max_cart_limit_error")):(null==i?void 0:i.is_unlimited_stock)==0&&(null==i?void 0:i.stock)==0?c.Am.error((0,a.t)("out_of_stock_message")):Number(d.is_unlimited_stock)?O(d,d.id,i,1,0,"add"):(console.log("variant?.status",null==i?void 0:i.status),(null==i?void 0:i.status)?O(d,d.id,i,1,0,"add"):c.Am.error((0,a.t)("out_of_stock_message")))},Z=(l,d,i)=>{var t;((null==l?void 0:null===(t=l.find(l=>(null==l?void 0:l.product_id)==(null==d?void 0:d.id)))||void 0===t?void 0:t.qty)||0)>=Number(null==d?void 0:d.total_allowed_quantity)?c.Am.error((0,a.t)("max_cart_limit_error")):(null==i?void 0:i.is_unlimited_stock)==0&&(null==i?void 0:i.stock)==0?c.Am.error((0,a.t)("out_of_stock_message")):Number(d.is_unlimited_stock)?S(d.id,i,1):(null==i?void 0:i.status)?S(d.id,i,1):c.Am.error((0,a.t)("out_of_stock_message"))},W=(l,d)=>{l.preventDefault();let t=P(null==b?void 0:b.cartProducts);(null==b?void 0:b.isGuest)?G(t,i,d):Z(t,i,d)},R=(l,d,i)=>{var t,o,n,e,r;let u=null==l?void 0:null===(t=l.find(l=>(null==l?void 0:l.product_id)==(null==d?void 0:d.id)))||void 0===t?void 0:t.qty;Number(d.is_unlimited_stock)?u<Number(null==d?void 0:d.total_allowed_quantity)?S(d.id,i,(null==b?void 0:null===(n=b.cartProducts)||void 0===n?void 0:null===(o=n.find(l=>(null==l?void 0:l.product_variant_id)==(null==i?void 0:i.id)))||void 0===o?void 0:o.qty)+1):c.Am.error((0,a.t)("max_cart_limit_error")):u>=Number(i.stock)?c.Am.error((0,a.t)("out_of_stock_message")):Number(u)>=Number(d.total_allowed_quantity)?c.Am.error((0,a.t)("max_cart_limit_error")):S(d.id,i,(null==b?void 0:null===(r=b.cartProducts)||void 0===r?void 0:null===(e=r.find(l=>(null==l?void 0:l.product_variant_id)==(null==i?void 0:i.id)))||void 0===e?void 0:e.qty)+1)},D=(l,d)=>{if(l.preventDefault(),l.stopPropagation(),null==b?void 0:b.isGuest){var t,o;V(P(null==b?void 0:b.guestCart),i,(null==b?void 0:null===(o=b.guestCart)||void 0===o?void 0:null===(t=o.find(l=>(null==l?void 0:l.product_id)==(null==i?void 0:i.id)&&(null==l?void 0:l.product_variant_id)==(null==d?void 0:d.id)))||void 0===t?void 0:t.qty)+1,d)}else R(P(null==b?void 0:b.cartProducts),i,d)},E=(l,d)=>{var t,o,n,e,r;l.preventDefault(),l.stopPropagation(),(null==b?void 0:b.isGuest)?O(i,null==i?void 0:i.id,d,(null==b?void 0:null===(o=b.guestCart)||void 0===o?void 0:null===(t=o.find(l=>(null==l?void 0:l.product_variant_id)==(null==d?void 0:d.id)))||void 0===t?void 0:t.qty)-1,1,"remove"):(null==b?void 0:null===(n=b.cartProducts)||void 0===n?void 0:n.find(l=>(null==l?void 0:l.product_variant_id)==(null==d?void 0:d.id)).qty)==1?A(null==i?void 0:i.id,d):S(i.id,d,(null==b?void 0:null===(r=b.cartProducts)||void 0===r?void 0:null===(e=r.find(l=>(null==l?void 0:l.product_variant_id)==(null==d?void 0:d.id)))||void 0===e?void 0:e.qty)-1)};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(o.Vq,{open:x,children:(0,t.jsxs)(o.cZ,{className:"max-w-xl ",children:[(0,t.jsxs)(o.fK,{className:"font-bold text-2xl text-start flex flex-row justify-between",children:[(0,a.t)("chooseVariant"),(0,t.jsx)("div",{children:(0,t.jsx)(u.FMH,{size:32,onClick:()=>{f(!1)}})})]}),(0,t.jsxs)("div",{className:"p-2 md:p-6",children:[(0,t.jsxs)("div",{className:"backgroundColor rounded-md flex gap-2 p-4 items-center",children:[(0,t.jsx)("div",{className:"h-[54px] w-[54px] relative rounded-md ",children:(0,t.jsx)(_.Z,{src:null==i?void 0:i.image_url,alt:null==i?void 0:i.name,className:"h-full w-full"})}),(0,t.jsx)("h3",{className:"font-medium text-base leading-[24px] break-all",children:null==i?void 0:i.name})]}),(0,t.jsx)("div",{children:null==i?void 0:null===(d=i.variants)||void 0===d?void 0:d.map(l=>{var d;let i=q(l),o=w(l),e=C(l);return(0,t.jsxs)("div",{className:"flex justify-between items-center px-4 py-2",children:[(0,t.jsx)("div",{className:"font-medium text-lg",children:"".concat(null==l?void 0:l.measurement," ").concat(null==l?void 0:l.stock_unit_name)}),(0,t.jsx)("div",{className:"flex items-center gap-1",children:(0,t.jsxs)("div",{className:"flex items-center gap-3 font-bold text-base ",children:[null==y?void 0:null===(d=y.setting)||void 0===d?void 0:d.currency,(null==l?void 0:l.discounted_price)==0?null==l?void 0:l.price:null==l?void 0:l.discounted_price,e?(0,t.jsx)("div",{className:"font-bold text-[#db3d26]",children:(0,a.t)("out_of_stock")}):i?(0,t.jsxs)("div",{className:"flex  items-center  justify-end w-[90px]",children:[(0,t.jsx)("button",{className:"primaryBackColor text-white w-8 h-7 p-1   rounded-[4px]",onClick:d=>E(d,l),children:(0,t.jsx)(v.ego,{})}),(0,t.jsx)("input",{value:o,type:"text",disabled:!0,className:"w-1/2  text-center bg-transparent"}),(0,t.jsx)("button",{className:" w-8 h-7 primaryBackColor text-white p-1 rounded-[4px]",onClick:d=>D(d,l),children:(0,t.jsx)(v.OvN,{})})]}):(0,t.jsxs)("button",{className:"flex gap-1 addToCartColor py-2 px-4 rounded-sm primaryColor justify-center font-semibold",onClick:d=>W(d,l),children:[(0,t.jsx)(n.b3Y,{size:20}),(0,a.t)("add")]})]})})]},null==l?void 0:l.id)})})]})]})}),(0,t.jsx)(m.Z,{showSingleSellerModal:N,setSingleSellerModal:k,product:i,selectedVariant:g})]})}}}]);