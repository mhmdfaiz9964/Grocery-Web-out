"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4565],{4565:function(e,l,t){t.r(l),t.d(l,{default:function(){return X}});var a=t(5893),d=t(7294),s=t(6114),o=t(3312),n=e=>{let{currentStep:l}=e;return(0,a.jsxs)("div",{className:"flex justify-center items-center space-x-4 my-8 w-full",children:[(0,a.jsxs)("div",{className:"flex flex-col justify-center gap-2 items-center",children:[(0,a.jsx)("div",{className:"flex items-center justify-center w-8 h-8 md:w-12 md:h-12 rounded-full  font-bold ".concat(l>=1?"primaryBackColor text-white":"backgroundColor "),children:"1"}),(0,a.jsx)("span",{children:(0,o.t)("address")})]}),(0,a.jsx)("div",{className:"flex-1 border-t-2  border-gray-400 border-dashed\n                    mb-4 p-2 w-full"}),(0,a.jsxs)("div",{className:"flex flex-col justify-center gap-2 items-center",children:[(0,a.jsx)("div",{className:"flex items-center justify-center w-8 h-8 md:w-12 md:h-12 rounded-full  font-bold bg-gray-400\n                    ".concat(l>=2?"primaryBackColor text-white":"backgroundColor "," \n                    "),children:"2"}),(0,a.jsx)("span",{children:(0,o.t)("schedule")})]}),(0,a.jsx)("div",{className:"flex-1 border-t-2  border-gray-400 border-dashed\n                 mb-4 p-2"}),(0,a.jsxs)("div",{className:"flex flex-col justify-center gap-2 items-center",children:[(0,a.jsx)("div",{className:"flex items-center justify-center w-8 h-8 md:w-12 md:h-12 rounded-full  font-bold ".concat(l>=3?"primaryBackColor text-white":"backgroundColor "),children:"3"}),(0,a.jsx)("span",{children:(0,o.t)("payment")})]})]})},i=t(7241),r=t(4318),c=t(6419),u=t(5383);let m=c.fC,v=c.xz;c.ee;let h=d.forwardRef((e,l)=>{let{className:t,align:d="center",sideOffset:s=4,...o}=e;return(0,a.jsx)(c.h_,{children:(0,a.jsx)(c.VY,{ref:l,align:d,sideOffset:s,className:(0,u.cn)("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...o})})});h.displayName=c.VY.displayName;var x=t(1258),p=t(4307),f=t(5555),y=t(8426);let g=(0,t(2003).j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}});function j(e){let{className:l,classNames:t,showOutsideDays:d=!0,...s}=e;return(0,a.jsx)(f._W,{showOutsideDays:d,className:(0,u.cn)("p-3",l),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:(0,u.cn)(g({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-8 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:(0,u.cn)("relative p-0 text-center text-sm focus-within:relative focus-within:z-20 [&:has([aria-selected])]:bg-accent [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected].day-range-end)]:rounded-r-md","range"===s.mode?"[&:has(>.day-range-end)]:rounded-r-md [&:has(>.day-range-start)]:rounded-l-md first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md":"[&:has([aria-selected])]:rounded-md"),day:(0,u.cn)(g({variant:"ghost"}),"h-8 w-8 p-0 font-normal aria-selected:opacity-100"),day_range_start:"day-range-start",day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground aria-selected:bg-accent/50 aria-selected:text-muted-foreground",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...t},components:{IconLeft:e=>{let{className:l,...t}=e;return(0,a.jsx)(x.Z,{className:(0,u.cn)("h-4 w-4",l),...t})},IconRight:e=>{let{className:l,...t}=e;return(0,a.jsx)(p.Z,{className:(0,u.cn)("h-4 w-4",l),...t})}},...s})}d.forwardRef((e,l)=>{let{className:t,variant:d,size:s,asChild:o=!1,...n}=e,i=o?y.g7:"button";return(0,a.jsx)(i,{className:(0,u.cn)(g({variant:d,size:s,className:t})),ref:l,...n})}).displayName="Button",j.displayName="Calendar";var b=t(5346),w=t(1534),_=t(5675),N=t.n(_),k=t(6737),C=t(5007),S=t(9938),P=t(2934),D=t(2507),Z=t(144),B=t(9394),M=t(145),A=t(4563),I=t(7986),z=t(6028),T=t(4057);let E=[{key:"razorpay_payment_method",label:"razorpay",image:Z.Z},{key:"paypal_payment_method",label:"paypal",image:B.Z},{key:"paystack_payment_method",label:"paystack",image:M.Z},{key:"stripe_payment_method",label:"stripe",image:A.Z},{key:"cashfree_payment_method",label:"cashfree",image:D.Z},{key:"midtrans_payment_method",label:"midtrans",image:I.Z},{key:"phonepay_payment_method",label:"phonepe",image:z.Z},{key:"paytabs_payment_method",label:"paytabs",image:T.Z}];var F=e=>{var l,t;let{checkoutData:s}=e,n=(0,C.I0)(),i=(0,C.v9)(e=>e.Setting),r=(0,C.v9)(e=>e.Checkout),c=(0,C.v9)(e=>e.User);(0,C.v9)(e=>e.Cart);let u=(0,d.useRef)(null),[m,v]=(0,d.useState)(null);(0,d.useEffect)(()=>{var e,l;(null==r?void 0:r.isWalletChecked)?v((null==r?void 0:r.usedWalletBalance)-(null==c?void 0:null===(e=c.user)||void 0===e?void 0:e.balance)):v(null==c?void 0:null===(l=c.user)||void 0===l?void 0:l.balance)},[c]);let h=e=>{n((0,S.$P)({data:e}))},x=E.filter(e=>{var l,t;return(null==i?void 0:null===(l=i.payment_setting)||void 0===l?void 0:l[e.key])&&(null==i?void 0:null===(t=i.payment_setting)||void 0===t?void 0:t[e.key])==="1"}),p=()=>{if(!u.current)return;let e=u.current.querySelector('[data-method="'.concat(null==r?void 0:r.selectedPaymentMethod,'"]'));e&&e.scrollIntoView({behavior:"smooth",block:"nearest"})};(0,d.useEffect)(()=>{(null==r?void 0:r.selectedPaymentMethod)&&p()},[null==r?void 0:r.selectedPaymentMethod]);let f=async()=>{var e,l,t,a,d,o;(null==r?void 0:r.isWalletChecked)?(n((0,S.$P)({data:null})),0==m?v(null==c?void 0:null===(d=c.user)||void 0===d?void 0:d.balance):(null==c?void 0:null===(a=c.user)||void 0===a?void 0:a.balance)>=(null==r?void 0:r.checkoutTotal)?v(m+(null==s?void 0:s.total_amount)):v(null==c?void 0:null===(o=c.user)||void 0===o?void 0:o.balance)):(null==c?void 0:null===(e=c.user)||void 0===e?void 0:e.balance)>=(null==s?void 0:s.total_amount)?(n((0,S.$P)({data:"wallet"})),n((0,S.vO)({data:null==r?void 0:r.checkoutTotal})),v(m-(null==r?void 0:r.checkoutTotal))):(null==c?void 0:null===(l=c.user)||void 0===l?void 0:l.balance)<=(null==s?void 0:s.total_amount)&&(v(0),n((0,S.vO)({data:null==c?void 0:null===(t=c.user)||void 0===t?void 0:t.balance}))),n((0,S.Rg)({data:!(null==r?void 0:r.isWalletChecked)}))};return(0,a.jsx)("div",{children:(0,a.jsxs)("div",{className:"flex flex-col cardBorder rounded-sm w-full",children:[(0,a.jsx)("div",{className:"flex justify-between backgroundColor p-4",children:(0,a.jsx)("span",{className:"font-bold text-xl",children:(0,o.t)("choose_payment_method")})}),(0,a.jsxs)("div",{className:"p-4 flex flex-col gap-2",children:[(null==c?void 0:null===(l=c.user)||void 0===l?void 0:l.balance)>=1&&(0,a.jsxs)("div",{className:"flex flex-col gap-3 mb-3",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("p",{className:"text-base font-bold",children:(0,o.t)("your_wallet")}),(0,a.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,a.jsx)("input",{type:"checkbox",className:"h-4 w-4",onChange:f,checked:null==r?void 0:r.isWalletChecked}),(0,a.jsx)("p",{children:(0,o.t)("use_wallet_balance")})]})]}),(0,a.jsxs)("div",{className:"rounded backgroundColor flex justify-between items-center p-2",children:[(0,a.jsxs)("div",{className:"flex gap-4 items-center font-medium text-base",children:[(0,a.jsx)(k.xiu,{size:40,className:"addToCartColor p-1 rounded-sm"}),(0,o.t)("walletBalance")]}),(0,a.jsxs)("div",{className:"font-bold text-xl",children:[null==i?void 0:null===(t=i.setting)||void 0===t?void 0:t.currency,null==m?void 0:m.toFixed(2)]})]})]}),(null==r?void 0:r.selectedPaymentMethod)=="wallet"?(0,a.jsx)(a.Fragment,{}):(0,a.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,a.jsx)("h1",{className:"text-base font-bold",children:(0,o.t)("payment_method")}),(0,a.jsxs)("div",{ref:u,className:"flex flex-col gap-2 h-full",children:[(null==s?void 0:s.cod_allowed)=="1"&&(0,a.jsxs)("div",{"data-method":"COD",className:"p-2 flex justify-between items-center cardBorder rounded-sm ".concat((null==r?void 0:r.selectedPaymentMethod)==="COD"?"addToCartColor":""),children:[(0,a.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,a.jsx)(N(),{src:P.Z,className:"h-8 w-8",height:0,width:0,alt:(0,o.t)("cod")}),(0,a.jsx)("p",{className:"font-medium text-base",children:(0,o.t)("cash_on_delivery")})]}),(0,a.jsx)("div",{children:(0,a.jsx)("input",{type:"radio",name:"payment_method",className:"h-6 w-6 mt-2",onChange:()=>h("COD"),checked:(null==r?void 0:r.selectedPaymentMethod)==="COD"})})]}),x.map(e=>(0,a.jsxs)("div",{"data-method":e.label,className:"p-2 flex justify-between items-center cardBorder rounded-sm ".concat((null==r?void 0:r.selectedPaymentMethod)===e.label?"addToCartColor":""),children:[(0,a.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,a.jsx)(N(),{src:e.image,className:"h-8 w-8",height:0,width:0,alt:(0,o.t)(e.label)}),(0,a.jsx)("p",{className:"font-medium text-base",children:(0,o.t)(e.label)})]}),(0,a.jsx)("div",{children:(0,a.jsx)("input",{type:"radio",name:"payment_method",className:"h-6 w-6 mt-2",onChange:()=>h(e.label),checked:(null==r?void 0:r.selectedPaymentMethod)===e.label})})]},e.key))]}),(0,a.jsx)("div",{className:"flex justify-end gap-4",children:(0,a.jsx)("button",{className:"cardBorder px-4 py-2 rounded-sm text-xl font-normal",onClick:()=>n((0,S.Bq)({data:2})),children:(0,o.t)("previous")})})]})]})]})})},O=t(1664),W=t.n(O),R=e=>{var l,t,s,n,i,r,c,u,m,v;let{step:h,checkoutData:x,handlePlaceOrder:p,checkOutError:f}=e,y=(0,C.I0)(),g=(0,C.v9)(e=>e.Setting.setting),j=(0,C.v9)(e=>e.User),b=(0,C.v9)(e=>e.Checkout),w=(0,C.v9)(e=>e.Cart);return(0,d.useEffect)(()=>{if(null==b?void 0:b.isWalletChecked){var e;let l=Math.max(((null==x?void 0:x.total_amount)||0)-((null==j?void 0:null===(e=j.user)||void 0===e?void 0:e.balance)||0),0);y((0,S.G0)({data:l}))}else y((0,S.G0)({data:(null==x?void 0:x.total_amount)||0}))},[null==b?void 0:b.isWalletChecked,null==x?void 0:x.total_amount,null==j?void 0:null===(l=j.user)||void 0===l?void 0:l.balance]),(0,a.jsxs)("div",{className:"w-full mx-auto cardBorder rounded-lg p-6 ",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,a.jsx)("span",{className:"font-bold ",children:(0,o.t)("sub_total")}),!1==f?(0,a.jsxs)("span",{className:"font-semibold ",children:[null==g?void 0:g.currency," ",null==x?void 0:null===(t=x.sub_total)||void 0===t?void 0:t.toFixed(2)]}):(0,a.jsxs)("span",{className:"font-semibold ",children:[null==g?void 0:g.currency," ",null==w?void 0:null===(n=w.cart)||void 0===n?void 0:null===(s=n.sub_total)||void 0===s?void 0:s.toFixed(2)]})]}),!1==f&&(0,a.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,a.jsx)("span",{className:"",children:(0,o.t)("delivery_charge")}),(0,a.jsxs)("span",{className:"",children:[null==g?void 0:g.currency," ",null==x?void 0:null===(i=x.delivery_charge)||void 0===i?void 0:i.total_delivery_charge]})]}),(null==x?void 0:x.promocode_details)&&!1==f&&(0,a.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,a.jsx)("a",{href:"#",className:"",children:(0,o.t)("promoDiscount")}),(0,a.jsxs)("span",{className:"",children:["- ",null==g?void 0:g.currency," ",null==x?void 0:null===(r=x.promocode_details)||void 0===r?void 0:r.discount]})]}),(null==b?void 0:b.isWalletChecked)&&(0,a.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,o.t)("wallet_balance_used"),(0,a.jsxs)("span",{className:"",children:["- ",null==g?void 0:g.currency," ",null==b?void 0:null===(c=b.usedWalletBalance)||void 0===c?void 0:c.toFixed(2)]})]}),(0,a.jsx)("hr",{className:"border-gray-300 mb-4"}),(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6 backgroundColor p-3 rounded-sm",children:[(0,a.jsx)("span",{className:"text-lg font-bold ",children:(0,o.t)("total")}),!1==f?(0,a.jsxs)("span",{className:"font-semibold ",children:[null==g?void 0:g.currency," ",(null==b?void 0:b.isWalletChecked)?(Number(null==x?void 0:x.total_amount)-Number(null==b?void 0:b.usedWalletBalance)).toFixed(2):null==x?void 0:null===(u=x.total_amount)||void 0===u?void 0:u.toFixed(2)]}):(0,a.jsxs)("span",{className:"font-semibold ",children:[null==g?void 0:g.currency," ",null==w?void 0:null===(v=w.cart)||void 0===v?void 0:null===(m=v.sub_total)||void 0===m?void 0:m.toFixed(2)]})]}),(0,a.jsx)("button",{className:"w-full primaryBackColor text-white font-semibold py-2 rounded-md  disabled:iconBackgroundColor disabled:cursor-not-allowed disabled:fontColor",disabled:3!==h,onClick:p,children:(0,o.t)("place_order")}),(0,a.jsx)("div",{className:"text-center rounded w-full hover:primaryBackColor hover:text-white p-2 mt-2",children:(0,a.jsx)(W(),{href:"/cart",className:" underline font-medium  w-full ",children:(0,o.t)("backToCart")})})]})},U=t(2052),q=t(7296),H=t(2537),V=t(7419),G=t(5678),$=t(1163),K=t(5516),L=t(6739),Y=t(9701);t(1159);var Q=t(549);t(9102);var J=()=>(0,a.jsxs)("div",{className:"flex justify-center flex-col items-center container",children:[(0,a.jsx)("div",{className:"flex w-full lg:w-1/2 justify-center my-8",children:(0,a.jsxs)("div",{className:"flex justify-center items-center space-x-4 w-full",children:[(0,a.jsxs)("div",{className:"flex flex-col justify-center gap-2 items-center",children:[(0,a.jsx)(Q.Z,{circle:!0,width:48,height:48}),(0,a.jsx)(Q.Z,{width:60,height:16})]}),(0,a.jsx)("div",{className:"flex-1 mb-4 p-2",children:(0,a.jsx)(Q.Z,{height:2})}),(0,a.jsxs)("div",{className:"flex flex-col justify-center gap-2 items-center",children:[(0,a.jsx)(Q.Z,{circle:!0,width:48,height:48}),(0,a.jsx)(Q.Z,{width:60,height:16})]}),(0,a.jsx)("div",{className:"flex-1 mb-4 p-2",children:(0,a.jsx)(Q.Z,{height:2})}),(0,a.jsxs)("div",{className:"flex flex-col justify-center gap-2 items-center",children:[(0,a.jsx)(Q.Z,{circle:!0,width:48,height:48}),(0,a.jsx)(Q.Z,{width:60,height:16})]})]})}),(0,a.jsx)("div",{className:"w-full",children:(0,a.jsxs)("div",{className:"grid grid-cols-12 gap-2 md:gap-6",children:[(0,a.jsx)("div",{className:"col-span-12 md:col-span-8 lg:col-span-9",children:(0,a.jsxs)("div",{className:"flex flex-col cardBorder rounded-sm mb-4",children:[(0,a.jsxs)("div",{className:"flex justify-between backgroundColor py-4 px-2 ",children:[(0,a.jsx)(Q.Z,{width:200,height:24}),(0,a.jsx)(Q.Z,{width:120,height:24})]}),[,,,].fill(0).map((e,l)=>(0,a.jsxs)("div",{className:"py-6 px-4 w-full border-b",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,a.jsx)(Q.Z,{width:180,height:20}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(Q.Z,{width:16,height:16,circle:!0}),(0,a.jsx)(Q.Z,{width:60,height:16,style:{marginLeft:"8px"}})]})]}),(0,a.jsx)(Q.Z,{width:100,height:16,style:{marginBottom:"8px"}}),(0,a.jsx)(Q.Z,{width:"90%",height:16,style:{marginBottom:"16px"}}),(0,a.jsxs)("div",{className:"flex items-center justify-between p-2 buttonBackground rounded-sm",children:[(0,a.jsx)(Q.Z,{width:150,height:20}),(0,a.jsxs)("div",{className:"flex md:space-x-1 flex-col md:flex-row",children:[(0,a.jsx)(Q.Z,{width:80,height:20}),(0,a.jsx)("span",{className:"p-1 border-r-2 hidden md:block"}),(0,a.jsx)(Q.Z,{width:80,height:20})]})]})]},l))]})}),(0,a.jsx)("div",{className:"md:col-span-4 lg:col-span-3 col-span-12",children:(0,a.jsxs)("div",{className:"cardBorder rounded-sm p-4",children:[(0,a.jsx)("div",{className:"font-bold text-xl mb-4",children:(0,a.jsx)(Q.Z,{width:150,height:24})}),(0,a.jsx)("div",{className:"flex flex-col gap-2 mb-4",children:(0,a.jsx)(Q.Z,{count:4,height:16})}),(0,a.jsx)("div",{className:"w-full h-[1px] bg-gray-300 my-2"}),(0,a.jsx)("div",{className:"flex flex-col gap-2 mb-4",children:(0,a.jsx)(Q.Z,{count:3,height:16})}),(0,a.jsx)("div",{className:"w-full h-[1px] bg-gray-300 my-2"}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)(Q.Z,{width:100,height:20}),(0,a.jsx)(Q.Z,{width:80,height:20})]}),(0,a.jsx)("div",{className:"mt-4",children:(0,a.jsx)(Q.Z,{height:40,borderRadius:4})})]})})]})})]}),X=()=>{var e,l,t,c,u,x;let p,f;let y=(0,$.useRouter)(),g=(0,C.I0)();(0,C.v9)(e=>e.City.city);let _=(0,C.v9)(e=>e.Cart),N=(0,C.v9)(e=>e.Addresses),k=(0,C.v9)(e=>e.User.user),P=(0,C.v9)(e=>e.Setting),D=(0,C.v9)(e=>e.Checkout),[Z,B]=(0,d.useState)(!1),[M,A]=(0,d.useState)(""),[I,z]=(0,d.useState)(!1),[T,E]=(0,d.useState)(!1),[O,W]=(0,d.useState)(!1),[Q,X]=(0,d.useState)(null),[ee,el]=(0,d.useState)(null),[et,ea]=(0,d.useState)(null),[ed,es]=(0,d.useState)(!1),[eo,en]=(0,d.useState)(!1),[ei,er]=(0,d.useState)(!1),[ec,eu]=(0,d.useState)(""),[em,ev]=(0,d.useState)(!1),[eh,ex]=(0,d.useState)(null),[ep,ef]=(0,d.useState)([]),[ey,eg]=(0,d.useState)([]),[ej,eb]=(0,d.useState)(null),[ew,e_]=(0,d.useState)(null),[eN,ek]=(0,d.useState)();(0,d.useEffect)(()=>{eD(),eB(),eC()},[]),(0,d.useEffect)(()=>{eS()},[null==_?void 0:_.cart,null==D?void 0:D.address,null==_?void 0:_.cartProducts]),(0,d.useEffect)(()=>{eP()},[null==_?void 0:_.cart,null==_?void 0:_.promo_code,null==D?void 0:D.address,null==_?void 0:_.cartProducts]);let eC=async()=>{try{let e=await q.PR();g((0,K.lx)({data:e.user}))}catch(e){console.log("error",e)}},eS=async()=>{try{var e;let l=await q.Zj({promoCodeName:null==_?void 0:null===(e=_.promo_code)||void 0===e?void 0:e.promo_code,amount:null==_?void 0:_.cartSubTotal});1==l.status?g((0,H.dt)({data:l.data})):g((0,H.lF)())}catch(e){console.log("Error",e)}};(0,d.useEffect)(()=>{eZ()},[null==D?void 0:D.selectedDate]);let eP=async()=>{var e,l,t,a;let d=null==_?void 0:null===(e=_.promo_code)||void 0===e?void 0:e.promo_code_id;try{let e=await q.dv({latitude:null==D?void 0:null===(l=D.address)||void 0===l?void 0:l.latitude,longitude:null==D?void 0:null===(t=D.address)||void 0===t?void 0:t.longitude,checkout:1,promocode_id:d});(null==e?void 0:e.status)==1?(g((0,H.BD)({data:null==e?void 0:e.data})),g((0,S.G0)({data:null==e?void 0:null===(a=e.data)||void 0===a?void 0:a.total_amount})),e_(null==e?void 0:e.data),er(!1)):(er(!0),eu(null==e?void 0:e.message))}catch(e){console.log("Error",e),er(!0)}},eD=async()=>{B(!0);try{let l=await q.Kn();if(1==l.status){var e;g((0,V.g$)({data:l.data}));let t=null==l?void 0:null===(e=l.data)||void 0===e?void 0:e.find(e=>1==e.is_default);g((0,S.qj)({data:t})),B(!1)}else B(!1),g((0,V.g$)({data:[]}))}catch(e){B(!1),console.log("Error",e)}},eZ=()=>{let e=new Date,l=new Date((null==D?void 0:D.selectedDate)?null==D?void 0:D.selectedDate:new Date);eg(ep.map(t=>{let a=new Date(null==D?void 0:D.selectedDate),[d,s,o]=t.last_order_time.split(":").map(Number);a.setHours(d,s,o);let n=l.toDateString()===e.toDateString();return{...t,isDisabled:n&&e>=a}}))},eB=async e=>{B(!0);try{var l;let t=await q.aN(),a=(null==t?void 0:null===(l=t.data)||void 0===l?void 0:l.time_slots)||[];ex(null==t?void 0:t.data),ef(a),eZ(e),B(!1)}catch(e){console.log("Error",e),B(!1)}},eM=e=>{g((0,S.hC)({data:e.target.value}))},eA=e=>{let l=new Date(e),t=String(l.getDate()).padStart(2,"0"),a=String(l.getMonth()+1).padStart(2,"0"),d=l.getFullYear();return"".concat(t,"-").concat(a,"-").concat(d)},eI=(e,l)=>{let t=eA(e);return l?"".concat(t," ").concat(l.title):t},ez=()=>new Promise(e=>{let l=document.createElement("script");l.src="https://checkout.razorpay.com/v1/checkout.js",l.onload=()=>{e(!0)},l.onerror=()=>{e(!1)},document.body.appendChild(l)}),eT=async(e,l,t,a)=>{try{var d,s,o,n,i,r,c,u;if(!await ez()){console.error("RazorPay SDK Load Failed");return}let m={key:null==P?void 0:null===(d=P.payment_setting)||void 0===d?void 0:d.razorpay_key,amount:Math.floor(100*t),currency:"INR",name:null==k?void 0:null===(s=k.user)||void 0===s?void 0:s.name,description:null==P?void 0:null===(o=P.setting)||void 0===o?void 0:o.app_name,image:null==P?void 0:null===(n=P.setting)||void 0===n?void 0:n.web_settings.web_logo,order_id:l,handler:async l=>{if(l.razorpay_payment_id)try{W(!0);let t=await q.dT({orderId:e,transactionId:l.razorpay_payment_id,paymentMethod:a,type:"order"});if(1===t.status)return W(!1),y.push("/web-payment-status?status=success&type=order&payment_method=".concat(null==D?void 0:D.selectedPaymentMethod,"&order_id=").concat(e));W(!1),G.Am.error(t.message)}catch(e){console.error("Transaction error:",e)}},modal:{confirm_close:!0,ondismiss:async l=>{void 0===l&&await eE(e)}},prefill:{name:null==k?void 0:null===(i=k.user)||void 0===i?void 0:i.name,email:null==k?void 0:null===(r=k.user)||void 0===r?void 0:r.email,contact:null==k?void 0:null===(c=k.user)||void 0===c?void 0:c.mobile},notes:{address:"Razorpay Corporate"},theme:{color:null==P?void 0:null===(u=P.setting)||void 0===u?void 0:u.web_settings.color}},v=new window.Razorpay(m);v.on("payment.cancel",l=>{eE(e)}),v.on("payment.failed",l=>{q.wH({orderId:e})}),v.open()}catch(e){console.error("Error initializing Razorpay:",e)}},eE=async e=>{await q.wH({orderId:e})},eF=async(e,l,t)=>{try{var a,d;Y.default.setup({key:P.payment_setting&&P.payment_setting.paystack_public_key,email:k&&(null==k?void 0:k.email),amount:100*parseFloat(l),currency:(null==P?void 0:P.payment_setting)&&(null==P?void 0:null===(a=P.payment_setting)||void 0===a?void 0:a.paystack_currency_code),ref:new Date().getTime().toString(),label:(null==P?void 0:P.setting)&&(null==P?void 0:null===(d=P.setting)||void 0===d?void 0:d.support_email),onClose:function(){q.wH({orderId:e})},callback:async function(l){try{W(!0);let a=await q.dT({orderId:e,transactionId:l.reference,paymentMethod:t,type:"order"});if(1==a.status)return W(!1),y.push("/web-payment-status?status=success&type=order&payment_method=".concat(null==D?void 0:D.selectedPaymentMethod,"&order_id=").concat(e));W(!1),G.Am.error(a.message),console.log("error",a)}catch(e){console.log("Error",e)}}}).openIframe()}catch(e){console.log("Paytabs Error",e)}},eO=async()=>{let e=eI(null==D?void 0:D.selectedDate,null==D?void 0:D.timeSlot),l=String(null==D?void 0:D.selectedPaymentMethod).charAt(0).toUpperCase()+String(null==D?void 0:D.selectedPaymentMethod).slice(1),t=(null==D?void 0:D.selectedPaymentMethod)==="COD"||(null==D?void 0:D.selectedPaymentMethod)==="wallet"?2:1;try{if((null==D?void 0:D.selectedPaymentMethod)==null){G.Am.error("Please select payment method");return}if((null==D?void 0:D.selectedDate)==null){G.Am.error("Please select date");return}if((null==D?void 0:D.address)==null){G.Am.error("Please select address");return}{var a,d,s,o,n,i,r,c,u;let m=await q.s1({productVariantId:null==_?void 0:null===(a=_.checkout)||void 0===a?void 0:a.product_variant_id,quantity:null==_?void 0:null===(d=_.checkout)||void 0===d?void 0:d.quantity,total:null==_?void 0:null===(s=_.checkout)||void 0===s?void 0:s.sub_total,deliveryCharge:null==_?void 0:null===(n=_.checkout)||void 0===n?void 0:null===(o=n.delivery_charge)||void 0===o?void 0:o.total_delivery_charge,finalTotal:null==D?void 0:D.checkoutTotal,walletUsed:null==D?void 0:D.isWalletChecked,walletBalance:null==D?void 0:D.usedWalletBalance,addressId:null==D?void 0:null===(i=D.address)||void 0===i?void 0:i.id,deliveryTime:e,orderNote:null==D?void 0:D.orderNote,paymentMethod:null==D?void 0:D.selectedPaymentMethod,promocodeId:null==_?void 0:null===(r=_.promo_code)||void 0===r?void 0:r.promo_code_id,status:t});(null==m?void 0:m.status)==1?(g((0,S.hC)("")),(null==D?void 0:D.selectedPaymentMethod)==="COD"||(null==D?void 0:D.selectedPaymentMethod)==="wallet"?await eW():(A(null==m?void 0:null===(c=m.data)||void 0===c?void 0:c.order_id),await eW(null==m?void 0:null===(u=m.data)||void 0===u?void 0:u.order_id,l))):G.Am.error(null==m?void 0:m.message)}}catch(e){console.log("Error",e)}},eW=async(e,l)=>{try{if((null==D?void 0:D.selectedPaymentMethod)=="COD"||(null==D?void 0:D.selectedPaymentMethod)=="wallet")return y.push("/web-payment-status?status=success&type=order&payment_method=".concat(null==D?void 0:D.selectedPaymentMethod));if((null==D?void 0:D.selectedPaymentMethod)=="paystack")eF(e,null==D?void 0:D.checkoutTotal,l);else{let c=await q.Gr({orderId:e,paymentMethod:l,type:"order"});if(1==c.status){var t,a,d,s,o,n,i,r;if((null==D?void 0:D.selectedPaymentMethod)=="phonepe"&&g((0,S.pF)(null==c?void 0:c.data)),(null==D?void 0:D.selectedPaymentMethod)=="razorpay")eT(e,null==c?void 0:null===(t=c.data)||void 0===t?void 0:t.transaction_id,null==D?void 0:D.checkoutTotal,l);else if((null==D?void 0:D.selectedPaymentMethod)=="stripe")X(e),el(null==c?void 0:null===(a=c.data)||void 0===a?void 0:a.client_secret),ea(null==c?void 0:null===(d=c.data)||void 0===d?void 0:d.id),z(!0);else{g((0,H.lF)());let e={cashfree:null==c?void 0:null===(s=c.data)||void 0===s?void 0:s.redirectUrl,phonepe:null==c?void 0:null===(o=c.data)||void 0===o?void 0:o.redirectUrl,paytabs:null==c?void 0:null===(n=c.data)||void 0===n?void 0:n.redirectUrl,paypal:null==c?void 0:null===(i=c.data)||void 0===i?void 0:i.paypal_redirect_url,midtrans:null==c?void 0:null===(r=c.data)||void 0===r?void 0:r.snapUrl}[null==D?void 0:D.selectedPaymentMethod];e?y.push(e):console.error("Unsupported payment method:",eN)}}else await q.wH({orderId:M})}}catch(e){console.log(e)}};return Z?(0,a.jsx)(J,{}):(0,a.jsxs)("section",{children:[(0,a.jsx)(s.Z,{}),(0,a.jsx)("div",{className:"container px-2",children:O?(0,a.jsx)(J,{}):(0,a.jsxs)("div",{className:"flex justify-center flex-col items-center",children:[(0,a.jsx)("div",{className:"flex w-full lg:w-1/2",children:(0,a.jsx)(n,{currentStep:null==D?void 0:D.currentStep})}),(0,a.jsx)("div",{className:"w-full",children:(0,a.jsxs)("div",{className:"grid grid-cols-12 gap-2 md:gap-6",children:[(null==D?void 0:D.currentStep)==1&&(0,a.jsx)("div",{className:"col-span-12 md:col-span-8 lg:col-span-9",children:(0,a.jsxs)("div",{className:"flex flex-col cardBorder rounded-sm mb-4",children:[(0,a.jsxs)("div",{className:"flex justify-between backgroundColor py-4 px-2 ",children:[(0,a.jsx)("span",{className:"font-bold text-base md:text-xl",children:(0,o.t)("choose_delivery_address")}),(null==N?void 0:null===(e=N.allAddresses)||void 0===e?void 0:e.length)>0&&(0,a.jsxs)("button",{className:"flex  items-center text-sm",onClick:()=>{es(!1),en(!0)},children:[(0,a.jsx)(r.ueT,{}),(0,o.t)("add_address")]})]}),(null==N?void 0:null===(l=N.allAddresses)||void 0===l?void 0:l.length)>0?(0,a.jsxs)(a.Fragment,{children:[" ",(0,a.jsx)("div",{className:"flex flex-col h-full",children:null==N?void 0:null===(t=N.allAddresses)||void 0===t?void 0:t.map(e=>(0,a.jsxs)("div",{children:[" ",(0,a.jsx)(i.Z,{address:e,setShowAddAddres:en,setIsAddressSelected:es,fetchAddress:eD})]},null==e?void 0:e.id))}),(0,a.jsx)("div",{className:"flex justify-end m-4",children:(0,a.jsx)("button",{onClick:()=>{if(ei){G.Am.error((0,o.t)(ec));return}g((0,S.Bq)({data:2}))},className:"text-white primaryBackColor px-4 py-2 rounded-sm text-xl font-normal",children:(0,o.t)("continue")})})]}):(0,a.jsx)("div",{className:" flex justify-center  my-2 cursor-pointer",onClick:()=>en(!0),children:(0,a.jsxs)("div",{className:"border-2 border-dashed p-3 w-1/3  flex items-center justify-center gap-2 font-bold text-xl",children:[(0,a.jsx)(r.HGK,{})," ",(0,o.t)("add_address")]})})]})}),(null==D?void 0:D.currentStep)==2&&(0,a.jsx)("div",{className:"col-span-12 md:col-span-8 lg:col-span-9",children:(0,a.jsxs)("div",{className:"flex flex-col cardBorder rounded-sm mb-4 w-full",children:[(0,a.jsx)("div",{className:"flex  justify-between backgroundColor p-4",children:(0,a.jsx)("span",{className:"font-bold text-xl",children:(0,o.t)("preferred_day_and_time")})}),(0,a.jsxs)("div",{className:"flex flex-col p-4 gap-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-12 items-center gap-4",children:[(0,a.jsxs)("div",{className:"col-span-12  md:col-span-6 flex flex-col gap-1 ",children:[(0,a.jsxs)("span",{className:"text-base font-bold",children:[(0,o.t)("preferred_delivery_day"),(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,a.jsxs)(m,{open:em,children:[(0,a.jsxs)(v,{className:"cardBorder w-full  px-4 py-2 rounded-sm items-center flex justify-between ",onClick:()=>ev(!em),children:[(u=null==D?void 0:D.selectedDate)?new Date(u).toLocaleDateString("en-US",{day:"2-digit",month:"long",year:"numeric"}):(0,o.t)("choose_date"),(0,a.jsx)(b.Pll,{})]}),(0,a.jsx)(h,{className:"w-full p-0",children:(0,a.jsx)(j,{mode:"single",selected:null==D?void 0:D.selectedDate,onSelect:e=>{e<new Date().setHours(0,0,0,0)&&G.Am.info("Please select a valid date"),g((0,S.jI)({data:e})),ev(!1)},className:"rounded-md w-full",fromDate:new Date,toDate:(p=new Date,f=parseInt(null==P?void 0:null===(x=P.setting)||void 0===x?void 0:x.time_slots_allowed_days)||15,p.setDate(p.getDate()+f),p)})})]})]}),(null==eh?void 0:eh.time_slots_is_enabled)=="true"&&(0,a.jsxs)("div",{className:"col-span-12 md:col-span-6  flex flex-col gap-1",children:[(0,a.jsxs)("span",{className:"text-base font-bold ",children:[(0,o.t)("preferred_delivery_time"),(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,a.jsxs)(w.Ph,{onValueChange:e=>{eb(e),g((0,S.KN)({data:e}))},value:ej,children:[(0,a.jsx)(w.i4,{className:"w-full py-5 cardBorder",children:(0,a.jsx)(w.ki,{placeholder:"Select a timezone",children:null==D?void 0:null===(c=D.timeSlot)||void 0===c?void 0:c.title})}),(0,a.jsx)(w.Bw,{children:null==ey?void 0:ey.map(e=>(0,a.jsx)("div",{children:(0,a.jsx)(w.Ql,{disabled:null==e?void 0:e.isDisabled,value:e,children:null==e?void 0:e.title})},null==e?void 0:e.id))})]})]})]}),(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("span",{className:"text-base font-bold ",children:(0,o.t)("order_note_title")}),(0,a.jsx)("textarea",{name:"",id:"",className:"cardBorder rounded-sm w-full p-2 outline-none",value:null==D?void 0:D.orderNote,onChange:e=>eM(e),placeholder:(0,o.t)("order_note")})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-4",children:[(0,a.jsx)("button",{className:"cardBorder px-4 py-2 rounded-sm text-xl font-normal",onClick:()=>g((0,S.Bq)({data:1})),children:(0,o.t)("previous")}),(0,a.jsx)("button",{className:"text-white primaryBackColor px-4 py-2 rounded-sm text-xl font-normal",onClick:()=>{if((null==D?void 0:D.selectedDate)==null){G.Am.error((0,o.t)("please_select_date"));return}if((null==eh?void 0:eh.time_slots_is_enabled)=="true"&&(null==D?void 0:D.timeSlot)==null){G.Am.error((0,o.t)("please_select_time_slot"));return}g((0,S.Bq)({data:3}))},children:(0,o.t)("continue")})]})]})]})}),(null==D?void 0:D.currentStep)==3&&(0,a.jsx)("div",{className:"md:col-span-8 lg:col-span-9 col-span-12",children:(0,a.jsx)(F,{checkoutData:ew,selectedPaymentMethod:eN,setSelectedPaymentMethod:ek,setCurrentStep:S.Bq})}),(0,a.jsx)("div",{className:" md:col-span-4 lg:col-span-3 col-span-12",children:(0,a.jsx)(R,{step:null==D?void 0:D.currentStep,checkoutData:ew,handlePlaceOrder:eO,checkOutError:ei})})]})})]})}),(0,a.jsx)(U.Z,{fetchAddress:eD,showAddAddres:eo,setShowAddAddres:en,isAddressSelected:ed}),(0,a.jsx)(L.Z,{showStripe:I,setShowStripe:z,amount:null==D?void 0:D.checkoutTotal,clientSecret:ee,stripeTransId:et,stripeOrderId:Q})]})}}}]);